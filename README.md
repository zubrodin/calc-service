# README

## Описание проекта

Этот проект представляет собой сервис для выполнения математических вычислений с использованием gRPC и HTTP API. Он включает в себя аутентификацию пользователей, обработку задач, выполнение вычислений и управление результатами. Сервис написан на языке Go и использует SQLite в качестве базы данных для хранения пользователей и задач.

## Содержание

- [Требования](#требования)
- [Установка](#установка)
- [Запуск](#запуск)
- [Использование API](#использование-api)
  - [Аутентификация](#аутентификация)
  - [Выполнение вычислений](#выполнение-вычислений)
- [Структура проекта](#структура-проекта)
- [Заключение](#заключение)

## Требования

- Go версии 1.23 или выше
- SQLite для работы с базой данных
- Установленные зависимости, указанные в `go.mod`

## Установка

1. Клонируйте репозиторий:

   ```bash
   git clone https://github.com/zubrodin/calc-service.git
   cd calc-service
   ```

2. Установите зависимости:

   ```bash
   go mod tidy
   ```

## Запуск

1. Убедитесь, что у вас установлен SQLite.
2. Установите переменные окружения для конфигурации:

   ```bash
   export DB_PATH="./calc.db"
   export SERVER_ADDRESS=":8080"
   export GRPC_ADDRESS=":50051"
   ```

3. Запустите сервер:

   ```bash
   go run ./cmd/server/main.go
   ```

Сервер будет доступен по адресу `http://localhost:8080` для HTTP API и `localhost:50051` для gRPC.

## Использование API

### Аутентификация

Для получения токена доступа выполните POST-запрос к конечной точке `/api/v1/login` с указанием имени пользователя и пароля.

**Запрос:**

```http
POST /api/v1/login
Content-Type: application/json

{
    "login": "testuser",
    "password": "password123"
}
```

**Ответ:**

При успешной аутентификации вы получите токен:

```json
{
    "token": "ваш_токен"
}
```

### Выполнение вычислений

После получения токена вы можете использовать его для выполнения математических операций. Включите токен в заголовок запроса.

#### Пример запроса на вычисление

**Запрос:**

```http
POST /api/v1/calculate
Authorization: Bearer ваш_токен
Content-Type: application/json

{
    "expression": "2 + 2"
}
```

**Ответ:**

При успешном выполнении вычисления вы получите результат:

```json
{
    "result": 4
}
```

## Структура проекта

- **cmd/**: Основные точки входа приложения.
- **internal/**: Внутренние пакеты, включая:
  - **app/**: Логика приложения, включая обработчики и маршрутизацию.
  - **auth/**: Аутентификация и управление токенами.
  - **config/**: Загрузка конфигурации.
  - **grpc/**: Генерируемые gRPC файлы.
  - **handler/**: HTTP-обработчики.
  - **repository/**: Интерфейсы и реализации для работы с базой данных.
  - **service/**: Основная бизнес-логика.
  - **pkg/**: Утилиты и вспомогательные функции (например, калькулятор и валидатор).
- **go.mod**: Файл зависимостей проекта.

## Заключение

Этот проект предоставляет простой и эффективный способ выполнения математических вычислений через API с использованием аутентификации. Вы можете расширять функциональность, добавляя новые операции или улучшая безопасность.

Если у вас есть вопросы или предложения, не стесняйтесь обращаться!
